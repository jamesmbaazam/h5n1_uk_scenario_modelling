---
title: H5N1 outbreak scenarios
author:
  - name: Joshua W. Lambert
    orcid: 0000-0001-5218-3046
    affiliations:
      - London School of Hygiene and Tropical Medicine
  - name: James M. Azam
    orcid: 0000-0001-5782-7330
    affiliations:
      - London School of Hygiene and Tropical Medicine
  - name: Billy J. Quilty
    orcid: 0000-0002-9094-3728
    affiliations: 
      - London School of Hygiene and Tropical Medicine
  - name: Timothy W. Russell
    orcid: 0000-0001-5610-6080
    affiliations: 
      - London School of Hygiene and Tropical Medicine
  - name: Jack Ward 
    affiliations:
      - London School of Hygiene and Tropical Medicine
  - name: W. John Edmunds
    orcid: 0000-0002-9179-2917
    corresponding: true
    email: john.edmunds@lshtm.ac.uk
    affiliations:
      - London School of Hygiene and Tropical Medicine
format: pdf
bibliography: references.bib
---

```{r}
#| echo: false
#| include: false
# install from outbreak_dist branch of {epichains}
# remotes::install_github("epiverse-trace/epichains@outbreak_dist")
library(epichains)
library(ggplot2)
library(superspreading)
library(dplyr)
```

```{r}
#| echo: false
#| include: false
R_by = 0.1
R_seq <- seq(0, 1.1, R_by)
k_seq <- c(0.1, 0.5, 1, 5, 1000)
breaks <- c(0, 1, 2, 5, 10, 20, 50, Inf)

df <- simulate_scenarios(
  offspring_dist = c("rpois", "rnbinom"), 
  statistic = c("size", "length"), 
  R_seq = R_seq, 
  k_seq = k_seq,
  breaks = breaks, 
  include_index_case = FALSE,
  right = FALSE
)
```

```{r}
#| echo: false
df2 <- subset(df, statistic == "size")
# this doesn't match all intended intervals so using loop
# sub_5_row_idx <- df2$interval == c("[0,1)", "[1,2)", "[2,5)")
sub_5_row_idx = c()
# here 7 is the constant for the number of breaks, update if updating cut
breaks = 7
param_sets <- nrow(df2) / breaks
for (i in seq_len(param_sets)) sub_5_row_idx = c(sub_5_row_idx, 1:3 + (breaks * (i - 1)))
df2 <- df2[sub_5_row_idx, ]
prop_sub_5_size <- dplyr::summarise(
  df2, 
  total_freq_sub_5 = sum(Freq), 
  .by = c("R", "k", "offspring_dist")
)
range_sub_5 <- paste0(
  signif(range(prop_sub_5_size$total_freq_sub_5) * 100, digits = 3), 
  "%", collapse = " to "
)

df3 <- subset(df2, k <= 0.5)
range_no_secondary <- paste0(
  signif(range(df3[df3$interval == "[0,1)", "Freq"]) * 100, digits = 3),
  "%", collapse = " to "
)
```


## Abstract

The H5N1 subtype of influenza has global spread in avian populations, but the newly established spread in dairy cattle in the United States of America and wild marine mammal populations raises concerns for transmission between mammals, including human-to-human transmission. There has been several recorded spillover infections in the U.S. over the last two years from direct exposure to infected poultry or cattle. However, on September 6th 2024, the Centers for Disease Control and Prevention (CDC) confirmed a human infection of avian influenza without a known exposure to an infected animal. Therefore, it is possible this case is part of a chain of human-to-human transmission. Here we use a simple branching process model to show that across a plausible range of transmissibility (reproduction number, $R$) and individual-level variability in transmission between humans ($k$), it is not highly unlikely to get a single case of onward influenza H5N1 human transmission, but that the size and length of the outbreak clusters are small, with outbreaks very unlikely to cause clusters of more than 5 people (across all simulated scenarios the percentage of outbreaks that did not reach 5 cases ranges from `{r} range_sub_5`). If variability in transmission between cases is high ($k \leq 0.5$) then the probability of having zero secondary cases is high (ranging from `{r} range_no_secondary` across all scenarios), albeit these scenarios pose a risk if highly infectious individuals cause sudden large clusters (i.e. superspreading). Therefore, it is highly probable that if the confirmed Missouri case was caused by human-to-human transmission, it is not part of an undetected large transmission chain. Our results use a range of parameters that are plausible given past influenza A/H5N1 estimates, but the time elapsed since means that viral evolution may have altered the transmission characteristics, so the situtation should still be monitored for epidemic/pandemic potential, especially if seeded by many spillover infections. 

## Background

Influenza virus subtype H5N1 (A/H5N1) is a RNA virus endemic (enzootic) to wild avian populations and poultry [@neumannH5N1InfluenzaVirulence2015]. This enzootic pathogen has seen widespread global circulation in bird populations, but in 2024 the virus spread into populations of dairy cattle in the United States of America [@u.s.centersfordiseasecontrolandpreventionH5BirdFlu2024; @eisfeldPathogenicityTransmissibilityBovine2024]. There have also been widespread deaths in wild marine mammal populations across South America [@decarvalhoaraujoMortalitySeaLions2024].

Between 2003 and July 2024 there have been 896 recorded human cases [@worldhealthorganisationCumulativeNumberConfirmed2024]. Historically, H5N1 influenza has not seeded outbreaks with sustained human-to-human transmission ($<10$ people per cluster) [@yangDetectingHumanHumanTransmission2007]. Therefore, the reproduction number is thought to be below one, with previous estimates of 0.1 - 0.25 [@aditamaAvianInfluenzaH5N12012], and one estimate for household clusters slightly above 1  ($R_0 = 1.14$ (0.61 - 2.14 95% CI, @yangDetectingHumanHumanTransmission2007)). Thus the there is a high likelihood of human-to-human transmission ceasing before creating substantial outbreaks without the need for interventions (e.g. vaccines or non-pharmaceutical interventions). The case fatality rate of H5N1 influenza has been $\sim 52\%$ [@worldhealthorganisationCumulativeNumberConfirmed2024], but recent detection of infections has resulted in less severe symptoms and mortality [@u.s.centersfordiseasecontrolandpreventionH5BirdFlu2024]. 

Since 2022, the CDC has confirmed 15 human cases of Influenza H5 [@u.s.centersfordiseasecontrolandpreventionH5BirdFlu2024], however, the most recent confirmed case, in the state of Missouri had no know exposure to infected animal source. This poses the question of whether this case is a single sporadic infection or if there is undetected sustained human-to-human transmission in the community. 

In this report we use a branching process framework to simulate the distribution of outbreak size and length [@deserresEpidemiologyTransmissibleDiseases2000; @farringtonBranchingProcessModels2003] to explore the epidemic/pandemic potential of a H5N1 outbreak under a range of plausible transmissibility scenarios, and assess the likelihood that a single human-to-human onward transmission would occur. Data to characterise the epidemiology of Influenza A/H5N1 transmission in human populations is sparse, and therefore this report covers a range of possible epidemiological scenarios, investigating highly variable individual-level transmission, and a range of subcritical ($R < 1$) transmission dynamics, with some scenarios where the reproduction number is slightly greater than 1 to simulate instances where sustained transmission and epidemic growth is more probable. 

## Methods

Here, we use a simple branching process to explore the transmission chain _size_ and _length_, across scenarios of varying reproduction number ($R$, there is no depletion of susceptible individuals or change in intrinsic transmissibility in the model so $R$ is equivalent to $R_0$) values, dispersion ($k$), and offspring distributions. The branching process is seeded with a single initial case and the offspring distributions used to simulate outbreaks are Poisson and Negative Binomial distributions.

We use a reproduction number ($R$) between `{r} min(R_seq)` and `{r} max(R_seq)` at `{r} R_by` intervals, and for the Negative Binomial offspring distribution, we vary the dispersion parameter ($k$) at `{r} k_seq`. Smaller values of $k$ signify more overdispersion in the individual-level transmissibility, in other words transmission is more heterogeneous and superspreading events are more likely. As $k$ increases individual-level transmission is more homogeneous and when $k \rightarrow \infty$ the Negative Binomial equals the Poisson offspring distribution. 

We are interested in the number of secondary cases produced in the outbreak. These are cases that are caused by human-to-human transmission, and not the primary/index case which can be a zoonotic transmission event. All transmission chain sizes and lengths presented below do not include the primary/index case. Thus, outbreaks can be of size and length 0 (red bar) when the primary cases does not infect anyone. We define the chain size as the total number of cases produced by a chain before it goes extinct, excluding the index case. The chain length, on the other hand, is the total number of generations reached by a chain before it goes extinct, not including the index case, so the first case infected from a human is generation one.

The branching process simulation is implemented in the {epichains} R package [@azamEpichainsSimulatingAnalysing2024], plots use the {ggplot2} R package [@wickhamGgplot22016], and metrics of superspreading are calculated with the {superspreading} R package [@lambertSuperspreadingEstimateIndividualLevel2024]. All analyses were run using R v4.2.3 [@rcoreteamLanguageEnvironmentStatistical2024]. All code to reproduce this report is open on GitHub at <https://github.com/jamesmbaazam/h5n1_uk_scenario_modelling>. The current version of this report uses the `simulate_scnearios()` function which is only available in the development version on {epichains} which can be found on the `outbreak_dist` branch.

## Results

When the offspring distribution is assumed to be Poisson distributed, when $R<0.6$ the majority of outbreaks do not cause any secondary transmission (@fig-pois-dist). For values of $R$ between 0.6 and 1.1 there is still a large proportion of outbreaks that do not cause any secondary transmission, with outbreak sizes of either 1 case, or between 2 and 4 cases. Outbreak clusters of more than 20 cases are rare but can occur when $R > 0.5$ (@fig-pois-dist).

```{r}
#| echo: false
#| fig-cap: "Distribution of outbreak length (right) and size (left) for a branching process model with a Poisson offspring distribution. The reproduction number ($R$), which for the Poisson model is equal to the mean and variance, of the offspring distribution is plotted on the $x$-axis at values 0.1 - 1.1."
#| label: fig-pois-dist
df |> 
  subset(offspring_dist == "rpois") |>
  ggplot2::ggplot() +
  ggplot2::geom_col(
    mapping = ggplot2::aes(x = as.factor(R), y = Freq, fill = interval)
  ) +
  ggplot2::scale_x_discrete(
    name = "Reproduction number (R)", 
    guide = ggplot2::guide_axis(n.dodge=2)
  ) +
  ggplot2::scale_y_continuous(name = "Proportion of outbreaks") +
  ggplot2::scale_fill_brewer(
    name = "Outbreak length or size", 
    palette = "Spectral"
  ) +
  ggplot2::facet_wrap(facets = c("statistic")) +
  ggplot2::labs(
    title = "Outbreak size and length for Poisson Branching Process"
  ) +
  ggplot2::theme_bw() + 
  ggplot2::theme(
    strip.background = ggplot2::element_blank(),
    plot.title = element_text(size = 12)
  )
```


When moderate individual-level heterogeneity in transmission is introduced to the model ($k = 0.5$) the proportion of index cases that produce secondary cases is reduced across all values of $R$ (@fig-nbinom-dist). The variation in transmission reduces the size and length of outbreaks as many cases will not transmit while a few individual will disproportionately infect others. However, given the value of the reproduction number being either below or only slight above unity the outbreaks that are seeded do not exceed 50 cases, even for our highest assumed value of $R$ (1.1) (@fig-nbinom-dist).

```{r}
#| echo: false
#| fig-cap: "Distribution of outbreak length (right) and size (left) for a branching process model with a Negative Binomial offspring distribution. The reproduction number ($R$) of the offspring distribution, which for the Negative Binomial distribution is parameterised as the mean, is plotted on the $x$-axis at values 0.1 - 1.1 and the dispersion $k$ is fixed at 0.5."
#| label: fig-nbinom-dist
df |> 
  subset(offspring_dist == "rnbinom" & k == 0.5) |>
  ggplot2::ggplot() +
  ggplot2::geom_col(
    mapping = ggplot2::aes(x = as.factor(R), y = Freq, fill = interval)
  ) +
  ggplot2::scale_x_discrete(
    name = "Reproduction number (R)",
    guide = ggplot2::guide_axis(n.dodge=2)
  ) +
  ggplot2::scale_y_continuous(name = "Proportion of outbreaks") +
  ggplot2::scale_fill_brewer(
    name = "Outbreak length or size", 
    palette = "Spectral"
  ) +
  ggplot2::facet_wrap(facets = "statistic") +
  ggplot2::labs(
    title = "Outbreak size and length for Negative Binomial Branching Process"
  ) +
  ggplot2::theme_bw() + 
  ggplot2::theme(
    strip.background = ggplot2::element_blank(),
    plot.title = element_text(size = 12)
  )
```

However, given our current understanding of H5N1 human-to-human transmission it is not clear how overdispersed transmission will be. Therefore, we explore a range of dispersion $k$ values between, $k = 0.1$, which represents highly heterogenous transmission dynamics, with approximately `{r} superspreading::proportion_transmission(R = 1, k = 0.1, percent_transmission = 0.2, method = "t_20")[, 3]` of secondary transmission caused by the most infectious 20% of cases; as well as $k$ values of 0.5 (same as @fig-nbinom-dist), 1, 5, and 1000 (approximately homogeneous transmission). The influence of decreasing $k$ is the same as shown in @fig-pois-dist and @fig-nbinom-dist, whereby more variability in onward human-to-human transmission results in a larger proportion of outbreaks producing fewer total infections (@fig-nbinom-size).

```{r}
#| echo: false
#| fig-cap: "Distribution of outbreak sizes for a Negative Binomial branching process model at various values of $R$ and $k$. The reproduction number ($R$) of the offspring distribution (mean) is plotted on the $x$-axis at values 0.1 - 1.1, and the plot is facetted by $k$ at values 0.1, 0.5, 1, 5, 1000. $k = 1000$ is approximately homogeneous transmission, i.e. equivalent to the Poisson offspring distribution."
#| label: fig-nbinom-size
df |> 
  subset(offspring_dist == "rnbinom" & statistic == "size") |>
  ggplot2::ggplot() +
  ggplot2::geom_col(
    mapping = ggplot2::aes(x = as.factor(R), y = Freq, fill = interval)
  ) +
  ggplot2::scale_x_discrete(
    name = "Reproduction number (R)",
    guide = ggplot2::guide_axis(n.dodge=2)
  ) +
  ggplot2::scale_y_continuous(name = "Proportion of outbreaks") +
  ggplot2::scale_fill_brewer(name = "Outbreak size", palette = "Spectral") +
  ggplot2::facet_wrap(
    facets = c("k"), 
    labeller = ggplot2::label_both
  ) +
  ggplot2::labs(
    title = "Outbreak size Negative Binomial Branching Process"
  ) +
  ggplot2::theme_bw() + 
  ggplot2::theme(strip.background = ggplot2::element_blank())
```

The outbreak length, in number of generation of transmission, shows a similar pattern to outbreak size. In many simulations the outbreak produces less than 5 generations of transmission before going extinct (@fig-nbinom-length). However, this is more generations of human-to-human transmission than seen for the current outbreak or previous outbeaks [@yangDetectingHumanHumanTransmission2007; @u.s.centersfordiseasecontrolandpreventionH5BirdFlu2024]

```{r}
#| echo: false
#| fig-cap: "Distribution of outbreak lengths for a Negative Binomial branching process model at various values of $R$ and $k$. The reproduction number ($R$) of the offspring distribution (mean) is plotted on the $x$-axis at values 0.1 - 1.1, and the plot is facetted by $k$ at values 0.1, 0.5, 1, 5, 1000. $k = 1000$ is approximately homogeneous transmission, i.e. equivalent to the Poisson offspring distribution."
#| label: fig-nbinom-length
df |> 
  subset(offspring_dist == "rnbinom" & statistic == "length") |>
  ggplot2::ggplot() +
  ggplot2::geom_col(
    mapping = ggplot2::aes(x = as.factor(R), y = Freq, fill = interval)
  ) +
  ggplot2::scale_x_discrete(
    name = "Reproduction number (R)",
    guide = ggplot2::guide_axis(n.dodge=2)
  ) +
  ggplot2::scale_y_continuous(name = "Proportion of outbreaks") +
  ggplot2::scale_fill_brewer(name = "Outbreak length", palette = "Spectral") +
  ggplot2::facet_wrap(
    facets = c("k"), 
    labeller = ggplot2::label_both
  ) +
  ggplot2::labs(
    title = "Outbreak length for Negative Binomial Branching Process"
  ) +
  ggplot2::theme_bw() + 
  ggplot2::theme(strip.background = ggplot2::element_blank())
```

# Conclusion

If influenza A/H5N1 has epidemiological characteristics closer to SARS [@lloyd-smithSuperspreadingEffectIndividual2005a] or MERS [@kucharskiRoleSuperspreadingMiddle2015] then the outbreaks will likely be self-limiting. If H5N1 transmission is more homogeneous, similar to other influenzas [@bruggerTransmissionSusceptibilitySeasonal2020], then larger outbreak clusters may be observed, although it is still highly improbable that even with homogeneous transmission and $R \sim 1.1$ that outbreak clusters will exceed 50 cases before stopping, without the need for any external intervention. 

The analysis conducted here has used a wide range of plausible epidemiological transmissability scenarios. The H5N1 clade circulating in poultry and dairy cattle is 2.3.4.4b, differing from the clades of goose/Guangdong lineage which caused the human-to-human transmission in 2005-2009 from which estimates of transmissibility are inferred and used to inform this report [@pawestriGeneticAntigenicCharacterization2020; @willeResurgenceAvianInfluenza2022]. This report can easily be updated with new epidemiological parameter estimates and rerun, with possible extensions if we obtain evidence that viral evolution of H5N1 is increasing it's transmissibility, such as reassortment from other influenza subtypes [@neumannH5N1InfluenzaVirulence2015].

## References

